webpackJsonp([1],{0:function(t,e,n){t.exports=n("NHnr")},"1EGf":function(t,e){},FIe8:function(t,e){},G3BA:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("/5sW"),a={token:""},i=n("mtWM"),r=n.n(i),s=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:localStorage.getItem("github-token"),e={Accept:"application/vnd.github.black-panther-preview+json","Content-type":"application/json"};return t&&(e.Authorization="token ".concat(t)),r.a.create({baseURL:"https://api.github.com",headers:e})},c=(r.a.create({baseURL:"https://github.com"}),{name:"App",data:function(){return{token:"",Data:a}},mounted:function(){a.token=this.token=localStorage.getItem("github-token")},methods:{setToken:function(){var t=this;this.testToken().then(function(e){"ok"===e?(a.token=t.token,localStorage.setItem("github-token",t.token),alert("token is ok")):alert("sorry, you hav'nt access to this blog")})},testToken:function(){var t=this;return s().get("/repos/benbenye/git-blog/contents/test-token").then(function(e){return s(t.token).put("/repos/benbenye/git-blog/contents/test-token",{message:"test token",sha:e.data.sha,content:""})}).then(function(t){return t.status<300?"ok":"fail"})}}}),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[t.Data.token?t._e():[n("input",{directives:[{name:"model",rawName:"v-model",value:t.token,expression:"token"}],attrs:{type:"text",placeholder:"请填写您的 github token，已确认您的身份"},domProps:{value:t.token},on:{input:function(e){e.target.composing||(t.token=e.target.value)}}}),n("div",{staticClass:"btn",on:{click:t.setToken}},[t._v("提交")])],n("div",{attrs:{id:"nav"}},[n("router-link",{attrs:{to:"/"}},[t._v("Home")])],1),n("router-view")],2)},l=[],p=n("XyMi");function d(t){n("G3BA")}var m=!1,f=d,h=null,v=null,g=Object(p["a"])(c,u,l,m,f,h,v),b=g.exports,k=n("/ocq"),y={name:"home",components:{},data:function(){return{files:[]}},mounted:function(){var t=this;s().get("/repos/benbenye/git-blog/contents").then(function(e){e.status<=299&&(t.files=e.data)})},methods:{getFileContents:function(t){return s().get("/repos/benbenye/git-blog/contents/".concat(t))},cut:function(t){s().delete("/repos/benbenye/git-blog/contents/".concat(t.path,"?message=delete&sha=").concat(t.sha))}}},_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("ul",t._l(t.files,function(e,o){return"file"===e.type?n("li",{key:o},[n("span",[t._v(t._s(e.name))]),n("router-link",{attrs:{to:{name:"edit",params:{path:e.path}}}},[t._v("修改")]),n("span",{staticClass:"delete",on:{click:function(n){t.cut(e)}}},[t._v("删除")])],1):t._e()})),n("router-link",{attrs:{to:"/new-blog"}},[t._v("新建博客")])],1)},w=[],M=!1,C=null,x=null,I=null,E=Object(p["a"])(y,_,w,M,C,x,I),j=E.exports,N=n("EFqf"),A=n.n(N),O=n("M4fF"),P=n.n(O),F={name:"MarkedEditor",props:{editor:{type:Object,required:!0},type:{type:String,required:!0}},data:function(){return{input:"edit"===this.type&&decodeURIComponent(escape(atob(this.editor.content))),createInput:"",title:"unnamed.md",commitMes:"commit"}},computed:{compiledMarkdown:function(){return"create"===this.type?"":A()(this.input,{sanitize:!0})}},methods:{updateContent:P.a.debounce(function(t){this.input=t.target.value},300),updateCreateContent:P.a.debounce(function(t){this.createInput=t.target.value},300),update:function(){s().put("/repos/benbenye/git-blog/contents/".concat(this.editor.path),{message:this.commitMes,sha:this.editor.sha,content:btoa(unescape(encodeURIComponent(this.input)))})},create:function(){s().put("/repos/benbenye/git-blog/contents/".concat(this.title),{path:this.title,message:this.commitMes,content:btoa(unescape(encodeURIComponent(this.createInput)))})}}},T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"editor"}},["edit"===t.type?[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],domProps:{value:t.input},on:{input:[function(e){e.target.composing||(t.input=e.target.value)},t.updateContent]}}),n("div",{domProps:{innerHTML:t._s(t.compiledMarkdown)}}),n("div",{attrs:{id:"update"},on:{click:t.update}},[t._v("更新")])]:[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.createInput,expression:"createInput"}],domProps:{value:t.createInput},on:{input:[function(e){e.target.composing||(t.createInput=e.target.value)},t.updateCreateContent]}}),n("div",{domProps:{innerHTML:t._s(t.compiledMarkdown)}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{type:"text",placeholder:"文章标题"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}}),n("div",{attrs:{id:"create"},on:{click:t.create}},[t._v("新建")])],n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commitMes,expression:"commitMes"}],domProps:{value:t.commitMes},on:{input:function(e){e.target.composing||(t.commitMes=e.target.value)}}})],2)},$=[];function U(t){n("1EGf")}var q=!1,G=U,H=null,R=null,L=Object(p["a"])(F,T,$,q,G,H,R),S=L.exports,B={components:{MarkedEditor:S},data:function(){return{contents:null,type:"edit"}},mounted:function(){var t=this;s().get("/repos/benbenye/git-blog/contents/".concat(this.$route.params.path)).then(function(e){e.status<=299&&(t.contents=e.data)})}},z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor"},[t.contents?n("marked-editor",{attrs:{editor:t.contents,type:t.type},on:{"update:editor":function(e){t.contents=e}}}):t._e()],1)},D=[],W=!1,J=null,X=null,K=null,Q=Object(p["a"])(B,z,D,W,J,X,K),V=Q.exports,Y={name:"new-blog",components:{MarkedEditor:S},data:function(){return{editor:{}}}},Z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"new"},[n("marked-editor",{attrs:{editor:t.editor,type:"create"}})],1)},tt=[];function et(t){n("FIe8")}var nt=!1,ot=et,at="data-v-267e5c30",it=null,rt=Object(p["a"])(Y,Z,tt,nt,ot,at,it),st=rt.exports;o["a"].use(k["a"]);var ct=new k["a"]({routes:[{path:"/",name:"home",component:j},{path:"/edit/:path",name:"edit",component:V},{path:"/new-blog",name:"new-blog",component:st}]}),ut=n("ydGU");Object(ut["a"])("".concat("/git-blog/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}}),o["a"].config.productionTip=!1,new o["a"]({router:ct,render:function(t){return t(b)}}).$mount("#app")}},[0]);
//# sourceMappingURL=app.69e0ce3e.js.map